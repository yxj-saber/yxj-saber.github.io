<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>django项目部署到阿里云服务器 | yxjsaber</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="yxj-saber, python">
    <meta name="description" content="yxj-saber个人博客">

    
    <link rel="alternative" href="/atom.xml" title="yxjsaber" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">yxjsaber</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/2019/01/21/django项目部署到阿里云服务器/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/2019/01/21/django项目部署到阿里云服务器/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/2019/01/21/django项目部署到阿里云服务器/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/2019/01/21/django项目部署到阿里云服务器/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/yxj-saber" target="_blank">Github</a>
                        |
                    
                        <a href="https://github.com/yxj-saber" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                        <a href="https://github.com/yxj-saber" class="sinaweibo" target="_blank"><b>■</b> 新浪微博</a>
                    
                        <a href="https://github.com/yxj-saber" class="qqweibo" target="_blank"><b>■</b> Facebook</a>
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="yxjsaber">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章页 -->
<!-- 文章 -->
<article class="post article">
    <header class="text-center">
        <h3 class="post-title"><span>django项目部署到阿里云服务器</span></h3>
    </header>
    <p class="post-meta text-center">
        yxjsaber 发表于
        <time datetime="2019-01-21T11:40:22.355Z">2019-01-21</time>
    </p>
    <div class="post-content">
        <h2 id="centos下django-nginx-uwsgi服务器部署"><a href="#centos下django-nginx-uwsgi服务器部署" class="headerlink" title="centos下django+nginx+uwsgi服务器部署"></a>centos下django+nginx+uwsgi服务器部署</h2><h3 id="1-安装MariaDB"><a href="#1-安装MariaDB" class="headerlink" title="1. 安装MariaDB"></a>1. 安装MariaDB</h3><ul>
<li>安装命令</li>
<li>设置密码</li>
<li>开启远程连接</li>
</ul>
<h3 id="2-安装python3-6"><a href="#2-安装python3-6" class="headerlink" title="2. 安装python3.6"></a>2. 安装python3.6</h3><ul>
<li>安装依赖包</li>
<li>下载python压缩包并安装</li>
<li>创建软链接</li>
</ul>
<h3 id="3-服务器创建文件"><a href="#3-服务器创建文件" class="headerlink" title="3. 服务器创建文件"></a>3. 服务器创建文件</h3><ul>
<li>创建部署所需的文件夹</li>
</ul>
<h3 id="4-安装环境"><a href="#4-安装环境" class="headerlink" title="4. 安装环境"></a>4. 安装环境</h3><ul>
<li>安装virtualenv</li>
<li>创建虚拟环境</li>
<li>安装环境所需的包</li>
</ul>
<h3 id="5-部署"><a href="#5-部署" class="headerlink" title="5. 部署"></a>5. 部署</h3><h4 id="5-1-测试环境中部署方式"><a href="#5-1-测试环境中部署方式" class="headerlink" title="5.1 测试环境中部署方式"></a>5.1 测试环境中部署方式</h4><ul>
<li>urls.py中的修改</li>
<li>中间件的修改</li>
</ul>
<h4 id="5-2-正式环境中部署方式"><a href="#5-2-正式环境中部署方式" class="headerlink" title="5.2 正式环境中部署方式"></a>5.2 正式环境中部署方式</h4><ul>
<li>安装nginx</li>
</ul>
<h4 id="5-3-配置uwsgi"><a href="#5-3-配置uwsgi" class="headerlink" title="5.3 配置uwsgi"></a>5.3 配置uwsgi</h4><ul>
<li>安装uwsgi</li>
</ul>
<h4 id="5-4-配置项目代码，配置项目nginx，配置uwsgi-ini等"><a href="#5-4-配置项目代码，配置项目nginx，配置uwsgi-ini等" class="headerlink" title="5.4 配置项目代码，配置项目nginx，配置uwsgi.ini等"></a>5.4 配置项目代码，配置项目nginx，配置uwsgi.ini等</h4><ul>
<li>配置nginx.conf文件</li>
<li>配置uwsgi.ini文件</li>
<li>运行项目</li>
</ul>
<hr>
<a id="more"></a>
<h3 id="1-安装MariaDB-1"><a href="#1-安装MariaDB-1" class="headerlink" title="1. 安装MariaDB"></a>1. 安装MariaDB</h3><ul>
<li><p>安装命令</p>
<p>安装MariaDB</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install mariadb mariadb-server</span><br></pre></td></tr></table></figure>
<p>安装完成后，启动MariaDB</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mariadb</span><br></pre></td></tr></table></figure>
<p>设置开机启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable mariadb</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置密码</p>
<p>命令：mysql_secure_installation</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Enter current password for root:&lt;–初次运行直接回车</span><br><span class="line"></span><br><span class="line">设置密码</span><br><span class="line"></span><br><span class="line">Set root password? [Y/n] &lt;– 是否设置root用户密码，输入y并回车或直接回车</span><br><span class="line"></span><br><span class="line">New password: &lt;– 设置root用户的密码</span><br><span class="line">Re-enter new password: &lt;– 再输入一次你设置的密码</span><br><span class="line"></span><br><span class="line">其他配置</span><br><span class="line"></span><br><span class="line">Remove anonymous users? [Y/n] &lt;– 是否删除匿名用户，回车</span><br><span class="line"></span><br><span class="line">Disallow root login remotely? [Y/n] &lt;–是否禁止root远程登录,回车,</span><br><span class="line"></span><br><span class="line">Remove test database and access to it? [Y/n] &lt;– 是否删除test数据库，回车</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? [Y/n] &lt;– 是否重新加载权限表，回车</span><br><span class="line"></span><br><span class="line">初始化MariaDB完成，接下来测试登录</span><br><span class="line"></span><br><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>开启远程连接</p>
<ul>
<li><p>创建用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 先使用数据库</span><br><span class="line">use mysql;</span><br><span class="line"></span><br><span class="line"># 针对ip</span><br><span class="line">create user &apos;root&apos;@&apos;192.168.10.10&apos; identified by &apos;password&apos;;</span><br><span class="line"></span><br><span class="line">#全部</span><br><span class="line"> create user &apos;root&apos;@&apos;%&apos; identified by &apos;password&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>授权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 给用户最大权限</span><br><span class="line">grant all privileges on *.* to &apos;root&apos;@&apos;%&apos; identified by &apos;password&apos;;</span><br><span class="line"></span><br><span class="line"># 给部分权限(test 数据库)</span><br><span class="line"></span><br><span class="line">grant all privileges on test.* to &apos;root&apos;@&apos;%&apos; identified by &apos;password&apos; with grant option;</span><br><span class="line"></span><br><span class="line"># 刷新权限表</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line"># 查看</span><br><span class="line">show grants for &apos;root&apos;@&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
<p>接下来就可以在远程的数据库可视化工具中直接访问改服务器中的mysql了</p>
</li>
</ul>
<h3 id="2-安装python3-6-1"><a href="#2-安装python3-6-1" class="headerlink" title="2. 安装python3.6"></a>2. 安装python3.6</h3><p>​    在centos中，系统默认只提供python2.7的版本，但是项目使用的是python3.6的版本。所以我们需要自己安装python3</p>
<ul>
<li><p>安装依赖包</p>
<p>安装python3.6所需要的依赖包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y groupinstall &quot;Development tools&quot;</span><br><span class="line"></span><br><span class="line">yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br></pre></td></tr></table></figure>
<p>安装python3.7还需要额外安装依赖包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libffi-devel -y</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载python压缩包并安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tar.xz</span><br><span class="line"></span><br><span class="line">然后解压压缩包，进入该目录，安装Python3</span><br><span class="line">tar -xvJf  Python-3.6.2.tar.xz</span><br><span class="line"></span><br><span class="line">cd Python-3.6.2</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr/local/python3</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建软链接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/python3/bin/python3 /usr/bin/python3</span><br><span class="line"></span><br><span class="line">ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-服务器创建文件-1"><a href="#3-服务器创建文件-1" class="headerlink" title="3. 服务器创建文件"></a>3. 服务器创建文件</h3><ul>
<li><p>创建部署所需的文件夹</p>
<p>在服务器的/home/路径下创建四个文件夹src, conf, env, logs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># src 用来放置工程文件</span><br><span class="line">mkdir src</span><br><span class="line"># conf 用来放置配置文件</span><br><span class="line">mkdir conf</span><br><span class="line"># env 用来放置虚拟环境文件</span><br><span class="line">mkdir env</span><br><span class="line"># logs 用来放置日志文件</span><br><span class="line">mkdir logs</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-安装环境-1"><a href="#4-安装环境-1" class="headerlink" title="4. 安装环境"></a>4. 安装环境</h3><ul>
<li><p>安装virtualenv</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install python-virtualenv</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建虚拟环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/env/</span><br><span class="line">virtualenv --no-site-packages -p [python3.6绝对路径] env[虚拟环境名字，假设为env]</span><br><span class="line">cd env</span><br><span class="line"># 激活虚拟环境</span><br><span class="line">source bin/activate</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装环境所需的包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip3 install -r requirements.txt</span><br><span class="line">pip3推荐使用虚拟环境的绝对路径</span><br><span class="line">requirements.ext是django项目下的安装包名称及其对应版本，</span><br><span class="line">上述命令可以直接安装其中的所有包和对应的版本</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-部署-1"><a href="#5-部署-1" class="headerlink" title="5. 部署"></a>5. 部署</h3><p>​    该部署采用的是cenots7系统来部署</p>
<p>​    Django的项目中，在工程目录下settings.py文件中有一个DEBUG=True参数，如果DEBUG=False则会出现js,css，img无法加载的情况出现。</p>
<p>原因如下：</p>
<p>​    Django框架仅在开发模式下提供静态文件服务。当我开启DEBUG模式时，Django内置的服务器是提供静态文件的服务的，所以css等文件访问都没有问题，但是关闭DEBUG模式后，Django便不提供静态文件服务了。想一想这是符合Django的哲学的：这部分事情标准服务器都很擅长，就让服务器去做吧！    </p>
<h4 id="5-1-测试环境中部署方式-1"><a href="#5-1-测试环境中部署方式-1" class="headerlink" title="5.1 测试环境中部署方式"></a>5.1 测试环境中部署方式</h4><ul>
<li><p>urls.py中的修改</p>
<p>在测试环境中一般都直接使用python manage.py runserver的方式去运行项目。其中就涉及到DEBUG=False的修改，静态目录的修改等，具体修改如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a) 修改settings.py配置文件中的DEBUG=False模式，修改ALLOEWD_HOST=[&apos;*&apos;]</span><br><span class="line"></span><br><span class="line">b) 修改工程目录下的urls.py</span><br><span class="line"></span><br><span class="line">from django.views.static import serve</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">    url(r&apos;^axf/&apos;, include(&apos;axf.urls&apos;, namespace=&apos;axf&apos;)),</span><br><span class="line"></span><br><span class="line">	# 增加以下的url路由</span><br><span class="line">    url(r&apos;^static/(?P&lt;path&gt;.*)$&apos;, serve, &#123;&quot;document_root&quot;: settings.STATICFILES_DIRS[0]&#125;),</span><br><span class="line">	</span><br><span class="line">	url(r&apos;^media/(?P&lt;path&gt;.*)$&apos;, serve, &#123;&quot;document_root&quot;: settings.MEDIA_ROOT&#125;),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    url(r&apos;^$&apos;, views.home)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>中间件的修改</p>
<p>如果中间件是过滤哪些地址不需要登录验证的话，可以设置如下的static和media过滤地址的参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 验证用户的登录状态</span><br><span class="line">paths = [&apos;/user/login/&apos;, &apos;/user/register/&apos;,</span><br><span class="line">         &apos;/axf/market/&apos;, &apos;/axf/marketparams/(\d+)/(\d+)/(\d+)/&apos;,</span><br><span class="line">        &apos;/static/[0-9a-zA-Z/\.]&apos;, &apos;/media/[0-9a-zA-Z/\.]&apos;]</span><br><span class="line"></span><br><span class="line">for path in paths:</span><br><span class="line">    if re.match(path, request.path):</span><br><span class="line">        return None</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-2-正式环境中部署方式-1"><a href="#5-2-正式环境中部署方式-1" class="headerlink" title="5.2 正式环境中部署方式"></a>5.2 正式环境中部署方式</h4><ul>
<li><p>安装nginx</p>
<ul>
<li><p>添加nginx存储库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx</span><br><span class="line"></span><br><span class="line">systemctl status nginx 查看nginx的状态</span><br><span class="line">systemctl start/stop/enable/disable/restart nginx 启动/关闭/设置开启启动/禁止开机启动/重启</span><br></pre></td></tr></table></figure>
</li>
<li><p>系统启动时启动nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果正在运行防火墙，请运行以下命令以运行HTTP和HTTPS通信</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --permanent --zone=public --add-service=http </span><br><span class="line"></span><br><span class="line">sudo firewall-cmd --permanent --zone=public --add-service=https</span><br><span class="line"></span><br><span class="line">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="5-3-配置uwsgi-1"><a href="#5-3-配置uwsgi-1" class="headerlink" title="5.3 配置uwsgi"></a>5.3 配置uwsgi</h4><ul>
<li><p>安装uwsgi</p>
<p>在虚拟环境中安装uwsgi，加设虚拟环境安装在/home/env/axfenv中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/env/axfenv/bin/pip3 install uwsgi</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-4-配置项目代码，配置项目nginx，配置uwsgi-ini等-1"><a href="#5-4-配置项目代码，配置项目nginx，配置uwsgi-ini等-1" class="headerlink" title="5.4 配置项目代码，配置项目nginx，配置uwsgi.ini等"></a>5.4 配置项目代码，配置项目nginx，配置uwsgi.ini等</h4><p>​    conf是配置文件，用于存放项目的nginx.conf文件，uwsgi.ini文件</p>
<p>​    logs是日志文件，用于存放nginx的启动成功和失败文件，以及uwsgi的运行日志文件</p>
<p>​    env是用于存放虚拟环境</p>
<p>​    src是项目文件，该目录下上传的是目录代码</p>
<ul>
<li><p>配置nginx.conf文件</p>
<p>每一个项目对应有一个自己的nginx的配置文件，定义一个axfnginx.conf文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">     listen       80;</span><br><span class="line">     server_name 39.108.251.113;</span><br><span class="line"></span><br><span class="line">     access_log /home/logs/access.log;</span><br><span class="line">     error_log /home/logs/error.log;</span><br><span class="line"></span><br><span class="line">     location / &#123;</span><br><span class="line">         include uwsgi_params;</span><br><span class="line">         uwsgi_pass 127.0.0.1:8890;</span><br><span class="line">     &#125;</span><br><span class="line">     location /static/ &#123;</span><br><span class="line">         alias /home/src/axf/static/;</span><br><span class="line">         expires 30d;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>修改总的nginx.conf的配置文件，让总的nginx文件包含我们自定义的项目的配置文件</p>
<p>总的nginx配置文件在：/etc/nginx/nginx.conf中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/nginx.conf</span><br><span class="line">在打开的文件的server上加：</span><br><span class="line">include /home/conf/*.conf</span><br></pre></td></tr></table></figure>
<p>以上步骤操作完成后，重启nginx服务器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置uwsgi.ini文件</p>
<p>在conf文件夹下创建axfuwsgi.ini文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line">projectname = axf</span><br><span class="line">base = /home/src</span><br><span class="line"></span><br><span class="line"># 守护进程</span><br><span class="line">master = true</span><br><span class="line"></span><br><span class="line"># 进程个数</span><br><span class="line">processes = 4</span><br><span class="line"></span><br><span class="line"># 虚拟环境</span><br><span class="line">pythonhome = /home/env/axfenv</span><br><span class="line"></span><br><span class="line"># 项目地址</span><br><span class="line">chdir = %(base)/%(projectname)</span><br><span class="line"></span><br><span class="line"># 指定python版本</span><br><span class="line">pythonpath = /usr/local/python3/bin/python3</span><br><span class="line"></span><br><span class="line"># 指定uwsgi文件</span><br><span class="line">module = %(projectname).wsgi</span><br><span class="line"></span><br><span class="line"># 和nginx通信地址:端口</span><br><span class="line">socket = 127.0.0.1:8890</span><br><span class="line"></span><br><span class="line"># 日志文件地址</span><br><span class="line">logto = /home/logs/uwsgi.log</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/env/asfenv/bin/uwsgi --ini axfuwsgi.ini</span><br></pre></td></tr></table></figure>
</li>
</ul>

    </div>
    <p class="post-meta">
        <span class="post-cat">分类：
            <a class="cat-link" href="/categories/web/">web</a>
        </span>
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/django/" title="django">django</a> / 
    
        <a href="/tags/nginx/" title="nginx">nginx</a> / 
    
        <a href="/tags/uwsgi/" title="uwsgi">uwsgi</a>
    

        </span>
    </p>
</article>
<!-- 分享按钮 -->

  <div class="article-share clearfix text-center">
    <div class="share-area">
      <span class="share-txt">分享到：</span>
      <a href="javascript: window.open('http://service.weibo.com/share/share.php?url=' + encodeURIComponent(location.href) + '&title=' + document.title + '&language=zh_cn');" class="share-icon weibo"></a>
      <a href="javascript: alert('请复制链接到微信并发送');" class="share-icon wechat"></a>
      <a href="javascript: window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=' + encodeURIComponent(location.href) + '&title=' + document.title);" class="share-icon qqzone"></a>
      <a href="javascript: window.open('http://connect.qq.com/widget/shareqq/index.html?url=' + encodeURIComponent(location.href) + '&desc=Jelon个人博客&title=' + document.title + '&callback=' + encodeURIComponent(location.href));" class="share-icon qq"></a>
      <a href="javascript: window.open('http://shuo.douban.com/!service/share?href=' + encodeURIComponent(location.href) + '&name=' + document.title + '&text=' + document.title);" class="share-icon douban"></a>
    </div>
  </div>


<!-- 上一篇/下一篇 -->

<div class="article-nav clearfix">
    
    <span class="prev fl">
        上一篇<br>
        <a href="/2020/11/15/少年游和雨霖铃/">
            
                少年游和雨霖铃
            
        </a>
    </span>
    

    
    <span class="next fr">
        下一篇<br>
        <a href="/2019/01/21/20190121/">
            
                hexo+git+github搭建博客
            
        </a>
    </span>
    
</div>

<!-- 文章评论 -->



            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/2018年12月/">2018年12月</a>
        <span class="badge">(6)</span>
    </li>
    
    <li>
        <a href="/categories/2019年1月/">2019年1月</a>
        <span class="badge">(6)</span>
    </li>
    
    <li>
        <a href="/categories/python/">python</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/web/">web</a>
        <span class="badge">(2)</span>
    </li>
    
    <li>
        <a href="/categories/nginx/">nginx</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/go/">go</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/git/">git</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/杂谈/">杂谈</a>
        <span class="badge">(2)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (4)</a>
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (3)</a>
  
    <a class="tag-item" href="/tags/python/" title="python">python (11)</a>
  
    <a class="tag-item" href="/tags/Redis/" title="Redis">Redis (2)</a>
  
    <a class="tag-item" href="/tags/linux/" title="linux">linux (3)</a>
  
    <a class="tag-item" href="/tags/Django/" title="Django">Django (7)</a>
  
    <a class="tag-item" href="/tags/Web前端/" title="Web前端">Web前端 (1)</a>
  
    <a class="tag-item" href="/tags/django/" title="django">django (2)</a>
  
    <a class="tag-item" href="/tags/hexo/" title="hexo">hexo (1)</a>
  
    <a class="tag-item" href="/tags/git/" title="git">git (2)</a>
  
    <a class="tag-item" href="/tags/github/" title="github">github (1)</a>
  
    <a class="tag-item" href="/tags/nginx/" title="nginx">nginx (2)</a>
  
    <a class="tag-item" href="/tags/go/" title="go">go (1)</a>
  
    <a class="tag-item" href="/tags/吴思/" title="吴思">吴思 (1)</a>
  
    <a class="tag-item" href="/tags/潜规则/" title="潜规则">潜规则 (1)</a>
  
    <a class="tag-item" href="/tags/宋词/" title="宋词">宋词 (1)</a>
  
    <a class="tag-item" href="/tags/uwsgi/" title="uwsgi">uwsgi (1)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="https://yxj-saber.github.io" target="_blank" title="yxj-saber个人博客">yxj-saber博客</a>
        </li>
    
        <li>
            <a href="https://www.baidu.com" target="_blank" title="百度搜索">百度搜索</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2018-2020
    

    <a href="/">yxjsaber Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>